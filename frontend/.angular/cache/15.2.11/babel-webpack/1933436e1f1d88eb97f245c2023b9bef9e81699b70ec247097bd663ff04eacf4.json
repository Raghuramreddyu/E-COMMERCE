{"ast":null,"code":"import { CommonModule } from '@angular/common';\nimport { RouterModule } from '@angular/router';\nimport { take } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../services/cart.service\";\nimport * as i2 from \"../../services/order.service\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"@angular/common\";\nfunction CheckoutPageComponent_div_3_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 4)(1, \"p\");\n    i0.ɵɵtext(2, \"Your cart is empty. Nothing to check out.\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"a\", 5);\n    i0.ɵɵtext(4, \"Go Shopping\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction CheckoutPageComponent_div_3_ng_template_2_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 11)(1, \"span\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"span\");\n    i0.ɵɵtext(4);\n    i0.ɵɵpipe(5, \"currency\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const item_r7 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate2(\"\", item_r7.product.name, \" (x\", item_r7.quantity, \")\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(5, 3, item_r7.product.price * item_r7.quantity, \"USD\"));\n  }\n}\nfunction CheckoutPageComponent_div_3_ng_template_2_p_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 12);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r6 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r6.errorMessage, \" \");\n  }\n}\nfunction CheckoutPageComponent_div_3_ng_template_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r9 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 6);\n    i0.ɵɵtemplate(1, CheckoutPageComponent_div_3_ng_template_2_div_1_Template, 6, 6, \"div\", 7);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(2, \"div\", 8)(3, \"strong\");\n    i0.ɵɵtext(4, \"Total:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"strong\");\n    i0.ɵɵtext(6);\n    i0.ɵɵpipe(7, \"currency\");\n    i0.ɵɵpipe(8, \"async\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(9, \"button\", 9);\n    i0.ɵɵlistener(\"click\", function CheckoutPageComponent_div_3_ng_template_2_Template_button_click_9_listener() {\n      i0.ɵɵrestoreView(_r9);\n      const ctx_r8 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r8.placeOrder());\n    });\n    i0.ɵɵtext(10);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(11, CheckoutPageComponent_div_3_ng_template_2_p_11_Template, 2, 1, \"p\", 10);\n  }\n  if (rf & 2) {\n    const items_r1 = i0.ɵɵnextContext().ngIf;\n    const ctx_r4 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", items_r1);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(7, 5, i0.ɵɵpipeBind1(8, 8, ctx_r4.totalPrice$), \"USD\"));\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"disabled\", ctx_r4.isPlacingOrder);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r4.isPlacingOrder ? \"Placing Order...\" : \"Place Order\", \" \");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r4.errorMessage);\n  }\n}\nfunction CheckoutPageComponent_div_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtemplate(1, CheckoutPageComponent_div_3_div_1_Template, 5, 0, \"div\", 2);\n    i0.ɵɵtemplate(2, CheckoutPageComponent_div_3_ng_template_2_Template, 12, 10, \"ng-template\", null, 3, i0.ɵɵtemplateRefExtractor);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const items_r1 = ctx.ngIf;\n    const _r3 = i0.ɵɵreference(3);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", items_r1.length === 0)(\"ngIfElse\", _r3);\n  }\n}\nexport let CheckoutPageComponent = /*#__PURE__*/(() => {\n  class CheckoutPageComponent {\n    constructor(cartService, orderService, router) {\n      this.cartService = cartService;\n      this.orderService = orderService;\n      this.router = router;\n      this.isPlacingOrder = false;\n      this.errorMessage = null;\n      this.cartItems$ = this.cartService.cartItems$;\n      this.totalPrice$ = this.cartService.totalPrice$;\n    }\n    placeOrder() {\n      this.isPlacingOrder = true;\n      this.errorMessage = null;\n      this.cartItems$.pipe(take(1)).subscribe({\n        next: items => {\n          if (items.length === 0) {\n            this.errorMessage = 'Your cart is empty.';\n            this.isPlacingOrder = false;\n            return;\n          }\n          this.orderService.placeOrder(items).subscribe({\n            next: response => {\n              console.log('Order placed successfully!', response);\n              // --- THIS IS THE CHANGE ---\n              // 1. REMOVE the old alert box:\n              // alert('Thank you for your order! It has been placed successfully.');\n              this.cartService.clearCart();\n              // 2. REDIRECT to the new confirmation page with the orderId from the backend.\n              this.router.navigate(['/order-confirmation', response.orderId]);\n              // -------------------------\n              this.isPlacingOrder = false;\n            },\n            error: err => {\n              console.error('Failed to place order', err);\n              this.errorMessage = 'There was a problem placing your order. Please try again.';\n              this.isPlacingOrder = false;\n            }\n          });\n        }\n      });\n    }\n    static {\n      this.ɵfac = function CheckoutPageComponent_Factory(t) {\n        return new (t || CheckoutPageComponent)(i0.ɵɵdirectiveInject(i1.CartService), i0.ɵɵdirectiveInject(i2.OrderService), i0.ɵɵdirectiveInject(i3.Router));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: CheckoutPageComponent,\n        selectors: [[\"app-checkout-page\"]],\n        standalone: true,\n        features: [i0.ɵɵStandaloneFeature],\n        decls: 5,\n        vars: 3,\n        consts: [[1, \"card\", \"checkout-container\"], [4, \"ngIf\"], [\"class\", \"empty-summary\", 4, \"ngIf\", \"ngIfElse\"], [\"summaryContent\", \"\"], [1, \"empty-summary\"], [\"routerLink\", \"/kits\", 1, \"btn-primary\"], [1, \"summary-items-list\"], [\"class\", \"summary-item\", 4, \"ngFor\", \"ngForOf\"], [1, \"summary-total\"], [1, \"btn-primary\", \"place-order-btn\", 3, \"disabled\", \"click\"], [\"class\", \"error-message\", 4, \"ngIf\"], [1, \"summary-item\"], [1, \"error-message\"]],\n        template: function CheckoutPageComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"div\", 0)(1, \"h2\");\n            i0.ɵɵtext(2, \"Checkout Summary\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵtemplate(3, CheckoutPageComponent_div_3_Template, 4, 2, \"div\", 1);\n            i0.ɵɵpipe(4, \"async\");\n            i0.ɵɵelementEnd();\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance(3);\n            i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(4, 1, ctx.cartItems$));\n          }\n        },\n        dependencies: [CommonModule, i4.NgForOf, i4.NgIf, i4.AsyncPipe, i4.CurrencyPipe, RouterModule, i3.RouterLink],\n        styles: [\"h2[_ngcontent-%COMP%]{text-align:center;margin-bottom:2rem;font-size:2.5rem;font-weight:700}.checkout-container[_ngcontent-%COMP%]{max-width:700px;margin:2rem auto}.empty-summary[_ngcontent-%COMP%]{text-align:center;padding:2rem}.empty-summary[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1.2rem;margin-bottom:2rem}.summary-items-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem;margin-bottom:1.5rem}.summary-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding-bottom:1rem;border-bottom:1px solid var(--subtle-borders)}.summary-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.summary-total[_ngcontent-%COMP%]{display:flex;justify-content:space-between;font-size:1.5rem;font-weight:700;padding:1.5rem 0;border-top:1px solid var(--subtle-borders)}.place-order-btn[_ngcontent-%COMP%]{width:100%;margin-top:1rem}.error-message[_ngcontent-%COMP%]{color:#f87171;background-color:#f871711a;border:1px solid #f87171;border-radius:8px;padding:1rem;margin-top:1rem;text-align:center}\"]\n      });\n    }\n  }\n  return CheckoutPageComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}