{"ast":null,"code":"import { CommonModule } from '@angular/common';\nimport { RouterModule } from '@angular/router';\nimport { take } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../services/cart.service\";\nimport * as i2 from \"../../services/order.service\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"@angular/common\";\nfunction CheckoutPageComponent_div_3_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 4)(1, \"p\");\n    i0.ɵɵtext(2, \"Your cart is empty. Nothing to check out.\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"a\", 5);\n    i0.ɵɵtext(4, \"Go Shopping\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction CheckoutPageComponent_div_3_ng_template_2_div_0_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 10)(1, \"span\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"span\");\n    i0.ɵɵtext(4);\n    i0.ɵɵpipe(5, \"currency\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const item_r7 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate2(\"\", item_r7.product.name, \" (x\", item_r7.quantity, \")\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(5, 3, item_r7.product.price * item_r7.quantity, \"USD\"));\n  }\n}\nfunction CheckoutPageComponent_div_3_ng_template_2_p_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 11);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r6 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r6.errorMessage, \" \");\n  }\n}\nfunction CheckoutPageComponent_div_3_ng_template_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r9 = i0.ɵɵgetCurrentView();\n    i0.ɵɵtemplate(0, CheckoutPageComponent_div_3_ng_template_2_div_0_Template, 6, 6, \"div\", 6);\n    i0.ɵɵelement(1, \"hr\");\n    i0.ɵɵelementStart(2, \"div\", 7)(3, \"strong\");\n    i0.ɵɵtext(4, \"Total:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"strong\");\n    i0.ɵɵtext(6);\n    i0.ɵɵpipe(7, \"currency\");\n    i0.ɵɵpipe(8, \"async\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(9, \"button\", 8);\n    i0.ɵɵlistener(\"click\", function CheckoutPageComponent_div_3_ng_template_2_Template_button_click_9_listener() {\n      i0.ɵɵrestoreView(_r9);\n      const ctx_r8 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r8.placeOrder());\n    });\n    i0.ɵɵtext(10);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(11, CheckoutPageComponent_div_3_ng_template_2_p_11_Template, 2, 1, \"p\", 9);\n  }\n  if (rf & 2) {\n    const items_r1 = i0.ɵɵnextContext().ngIf;\n    const ctx_r4 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"ngForOf\", items_r1);\n    i0.ɵɵadvance(6);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(7, 5, i0.ɵɵpipeBind1(8, 8, ctx_r4.totalPrice$), \"USD\"));\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"disabled\", ctx_r4.isPlacingOrder);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r4.isPlacingOrder ? \"Placing Order...\" : \"Place Order\", \" \");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r4.errorMessage);\n  }\n}\nfunction CheckoutPageComponent_div_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtemplate(1, CheckoutPageComponent_div_3_div_1_Template, 5, 0, \"div\", 2);\n    i0.ɵɵtemplate(2, CheckoutPageComponent_div_3_ng_template_2_Template, 12, 10, \"ng-template\", null, 3, i0.ɵɵtemplateRefExtractor);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const items_r1 = ctx.ngIf;\n    const _r3 = i0.ɵɵreference(3);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", items_r1.length === 0)(\"ngIfElse\", _r3);\n  }\n}\nexport class CheckoutPageComponent {\n  constructor(cartService, orderService, router) {\n    this.cartService = cartService;\n    this.orderService = orderService;\n    this.router = router;\n    this.isPlacingOrder = false;\n    this.errorMessage = null;\n    this.cartItems$ = this.cartService.cartItems$;\n    this.totalPrice$ = this.cartService.totalPrice$;\n  }\n  placeOrder() {\n    this.isPlacingOrder = true;\n    this.errorMessage = null;\n    this.cartItems$.pipe(take(1)).subscribe({\n      next: items => {\n        if (items.length === 0) {\n          this.errorMessage = 'Your cart is empty.';\n          this.isPlacingOrder = false;\n          return;\n        }\n        this.orderService.placeOrder(items).subscribe({\n          next: response => {\n            console.log('Order placed successfully!', response);\n            // --- THIS IS THE CHANGE ---\n            // 1. REMOVE the old alert box:\n            // alert('Thank you for your order! It has been placed successfully.');\n            this.cartService.clearCart();\n            // 2. REDIRECT to the new confirmation page with the orderId from the backend.\n            this.router.navigate(['/order-confirmation', response.orderId]);\n            // -------------------------\n            this.isPlacingOrder = false;\n          },\n          error: err => {\n            console.error('Failed to place order', err);\n            this.errorMessage = 'There was a problem placing your order. Please try again.';\n            this.isPlacingOrder = false;\n          }\n        });\n      }\n    });\n  }\n  static {\n    this.ɵfac = function CheckoutPageComponent_Factory(t) {\n      return new (t || CheckoutPageComponent)(i0.ɵɵdirectiveInject(i1.CartService), i0.ɵɵdirectiveInject(i2.OrderService), i0.ɵɵdirectiveInject(i3.Router));\n    };\n  }\n  static {\n    this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: CheckoutPageComponent,\n      selectors: [[\"app-checkout-page\"]],\n      standalone: true,\n      features: [i0.ɵɵStandaloneFeature],\n      decls: 5,\n      vars: 3,\n      consts: [[1, \"checkout-container\"], [4, \"ngIf\"], [\"class\", \"empty-summary\", 4, \"ngIf\", \"ngIfElse\"], [\"summaryContent\", \"\"], [1, \"empty-summary\"], [\"routerLink\", \"/kits\", 1, \"button\"], [\"class\", \"summary-item\", 4, \"ngFor\", \"ngForOf\"], [1, \"summary-total\"], [1, \"button\", \"place-order-btn\", 3, \"disabled\", \"click\"], [\"class\", \"error-message\", 4, \"ngIf\"], [1, \"summary-item\"], [1, \"error-message\"]],\n      template: function CheckoutPageComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"div\", 0)(1, \"h2\");\n          i0.ɵɵtext(2, \"Checkout Summary\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(3, CheckoutPageComponent_div_3_Template, 4, 2, \"div\", 1);\n          i0.ɵɵpipe(4, \"async\");\n          i0.ɵɵelementEnd();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(3);\n          i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(4, 1, ctx.cartItems$));\n        }\n      },\n      dependencies: [CommonModule, i4.NgForOf, i4.NgIf, i4.AsyncPipe, i4.CurrencyPipe, RouterModule, i3.RouterLink],\n      styles: [\".checkout-container[_ngcontent-%COMP%] {\\r\\n    max-width: 600px;\\r\\n    margin: 2rem auto;\\r\\n    padding: 2rem;\\r\\n    border: 1px solid var(--subtle-borders);\\r\\n    border-radius: 10px;\\r\\n}\\r\\n\\r\\n.checkout-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%] {\\r\\n    text-align: center;\\r\\n    margin-bottom: 2rem;\\r\\n}\\r\\n\\r\\n.order-item[_ngcontent-%COMP%] {\\r\\n    display: flex;\\r\\n    justify-content: space-between;\\r\\n    padding: 0.5rem 0;\\r\\n}\\r\\n\\r\\n.order-total[_ngcontent-%COMP%] {\\r\\n    text-align: right;\\r\\n    margin-top: 1rem;\\r\\n}\\r\\n\\r\\n.checkout-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] {\\r\\n    width: 100%;\\r\\n    margin-top: 2rem;\\r\\n    padding: 15px;\\r\\n    font-size: 1.1rem;\\r\\n}\\r\\n\\r\\n.order-success[_ngcontent-%COMP%] {\\r\\n    text-align: center;\\r\\n    padding: 2rem;\\r\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvcGFnZXMvY2hlY2tvdXQvY2hlY2tvdXQuY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtJQUNJLGdCQUFnQjtJQUNoQixpQkFBaUI7SUFDakIsYUFBYTtJQUNiLHVDQUF1QztJQUN2QyxtQkFBbUI7QUFDdkI7O0FBRUE7SUFDSSxrQkFBa0I7SUFDbEIsbUJBQW1CO0FBQ3ZCOztBQUVBO0lBQ0ksYUFBYTtJQUNiLDhCQUE4QjtJQUM5QixpQkFBaUI7QUFDckI7O0FBRUE7SUFDSSxpQkFBaUI7SUFDakIsZ0JBQWdCO0FBQ3BCOztBQUVBO0lBQ0ksV0FBVztJQUNYLGdCQUFnQjtJQUNoQixhQUFhO0lBQ2IsaUJBQWlCO0FBQ3JCOztBQUVBO0lBQ0ksa0JBQWtCO0lBQ2xCLGFBQWE7QUFDakIiLCJzb3VyY2VzQ29udGVudCI6WyIuY2hlY2tvdXQtY29udGFpbmVyIHtcclxuICAgIG1heC13aWR0aDogNjAwcHg7XHJcbiAgICBtYXJnaW46IDJyZW0gYXV0bztcclxuICAgIHBhZGRpbmc6IDJyZW07XHJcbiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1zdWJ0bGUtYm9yZGVycyk7XHJcbiAgICBib3JkZXItcmFkaXVzOiAxMHB4O1xyXG59XHJcblxyXG4uY2hlY2tvdXQtY29udGFpbmVyIGgyIHtcclxuICAgIHRleHQtYWxpZ246IGNlbnRlcjtcclxuICAgIG1hcmdpbi1ib3R0b206IDJyZW07XHJcbn1cclxuXHJcbi5vcmRlci1pdGVtIHtcclxuICAgIGRpc3BsYXk6IGZsZXg7XHJcbiAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47XHJcbiAgICBwYWRkaW5nOiAwLjVyZW0gMDtcclxufVxyXG5cclxuLm9yZGVyLXRvdGFsIHtcclxuICAgIHRleHQtYWxpZ246IHJpZ2h0O1xyXG4gICAgbWFyZ2luLXRvcDogMXJlbTtcclxufVxyXG5cclxuLmNoZWNrb3V0LWNvbnRhaW5lciBidXR0b24ge1xyXG4gICAgd2lkdGg6IDEwMCU7XHJcbiAgICBtYXJnaW4tdG9wOiAycmVtO1xyXG4gICAgcGFkZGluZzogMTVweDtcclxuICAgIGZvbnQtc2l6ZTogMS4xcmVtO1xyXG59XHJcblxyXG4ub3JkZXItc3VjY2VzcyB7XHJcbiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XHJcbiAgICBwYWRkaW5nOiAycmVtO1xyXG59XHJcbiJdLCJzb3VyY2VSb290IjoiIn0= */\"]\n    });\n  }\n}","map":{"version":3,"mappings":"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","names":["CommonModule","RouterModule","take","i0","CheckoutPageComponent","constructor","cartService","orderService","router","cartItems$","totalPrice$","placeOrder","isPlacingOrder","errorMessage","pipe","subscribe","next","items","length","response","console","log","clearCart","navigate","orderId","error","err","selectors","standalone","features","decls","vars","consts","template","styles"],"sourceRoot":"","sources":["C:\\Users\\91630\\OneDrive\\Desktop\\E-Commerce-Website\\frontend\\src\\app\\pages\\checkout\\checkout.component.ts"],"sourcesContent":["import { Component } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { Router, RouterModule } from '@angular/router';\r\nimport { Observable, take } from 'rxjs';\r\nimport { CartService, CartItem } from '../../services/cart.service';\r\nimport { OrderService } from '../../services/order.service';\r\n\r\n@Component({\r\n  selector: 'app-checkout-page',\r\n  standalone: true,\r\n  imports: [CommonModule, RouterModule],\r\n  template: `\r\n    <div class=\"checkout-container\">\r\n      <h2>Checkout Summary</h2>\r\n      <div *ngIf=\"(cartItems$ | async) as items\">\r\n        <div *ngIf=\"items.length === 0; else summaryContent\" class=\"empty-summary\">\r\n          <p>Your cart is empty. Nothing to check out.</p>\r\n          <a routerLink=\"/kits\" class=\"button\">Go Shopping</a>\r\n        </div>\r\n        \r\n        <ng-template #summaryContent>\r\n          <!-- List of items in the cart -->\r\n          <div class=\"summary-item\" *ngFor=\"let item of items\">\r\n            <span>{{ item.product.name }} (x{{ item.quantity }})</span>\r\n            <span>{{ (item.product.price * item.quantity) | currency:'USD' }}</span>\r\n          </div>\r\n          <hr>\r\n          <!-- Total price -->\r\n          <div class=\"summary-total\">\r\n            <strong>Total:</strong>\r\n            <strong>{{ (totalPrice$ | async) | currency:'USD' }}</strong>\r\n          </div>\r\n          \r\n          <!-- Place Order Button with loading state -->\r\n          <button (click)=\"placeOrder()\" [disabled]=\"isPlacingOrder\" class=\"button place-order-btn\">\r\n            {{ isPlacingOrder ? 'Placing Order...' : 'Place Order' }}\r\n          </button>\r\n          \r\n          <!-- Error message display -->\r\n          <p *ngIf=\"errorMessage\" class=\"error-message\">\r\n            {{ errorMessage }}\r\n          </p>\r\n        </ng-template>\r\n      </div>\r\n    </div>\r\n  `,\r\n  styleUrls: ['./checkout.component.css']\r\n})\r\nexport class CheckoutPageComponent {\r\n  cartItems$: Observable<CartItem[]>;\r\n  totalPrice$: Observable<number>;\r\n  isPlacingOrder = false;\r\n  errorMessage: string | null = null;\r\n\r\n  constructor(\r\n    private cartService: CartService,\r\n    private orderService: OrderService,\r\n    private router: Router\r\n  ) {\r\n    this.cartItems$ = this.cartService.cartItems$;\r\n    this.totalPrice$ = this.cartService.totalPrice$;\r\n  }\r\n\r\n  placeOrder(): void {\r\n    this.isPlacingOrder = true;\r\n    this.errorMessage = null;\r\n\r\n    this.cartItems$.pipe(take(1)).subscribe({\r\n      next: (items) => {\r\n        if (items.length === 0) {\r\n          this.errorMessage = 'Your cart is empty.';\r\n          this.isPlacingOrder = false;\r\n          return;\r\n        }\r\n\r\n        this.orderService.placeOrder(items).subscribe({\r\n          next: (response) => {\r\n            console.log('Order placed successfully!', response);\r\n            \r\n            // --- THIS IS THE CHANGE ---\r\n            // 1. REMOVE the old alert box:\r\n            // alert('Thank you for your order! It has been placed successfully.');\r\n            \r\n            this.cartService.clearCart(); \r\n\r\n            // 2. REDIRECT to the new confirmation page with the orderId from the backend.\r\n            this.router.navigate(['/order-confirmation', response.orderId]);\r\n            // -------------------------\r\n\r\n            this.isPlacingOrder = false;\r\n          },\r\n          error: (err) => {\r\n            console.error('Failed to place order', err);\r\n            this.errorMessage = 'There was a problem placing your order. Please try again.';\r\n            this.isPlacingOrder = false;\r\n          }\r\n        });\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}